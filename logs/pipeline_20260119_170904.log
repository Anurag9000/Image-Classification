2026-01-19 17:09:04,219 - INFO - Loading config from: configs/garbage_edge.yaml
2026-01-19 17:09:04,230 - INFO - ===> Starting SupCon Pretraining Phase
2026-01-19 17:09:05,856 - INFO - JsonDataset loaded 617837 images. Classes: {'organic': 0, 'other': 1, 'paper': 2, 'plastic': 3}
2026-01-19 17:09:06,471 - INFO - Loading pretrained weights from Hugging Face hub (timm/resnet50.a1_in1k)
2026-01-19 17:09:06,773 - INFO - [timm/resnet50.a1_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2026-01-19 17:09:07,218 - INFO - HybridBackbone Dimensions Detected -> CNN: 2048, ViT: 0
2026-01-19 17:09:07,224 - INFO - CBAM initialized with channels: 2048
2026-01-19 17:09:32,677 - INFO - SupCon Step [10/100] - Loss: 4.6109
2026-01-19 17:09:54,299 - INFO - SupCon Step [20/100] - Loss: 4.1561
2026-01-19 17:10:15,193 - INFO - SupCon Step [30/100] - Loss: 4.4263
2026-01-19 17:10:44,991 - INFO - SupCon Step [40/100] - Loss: 5.8832
2026-01-19 17:11:05,992 - INFO - SupCon Step [50/100] - Loss: 3.7867
2026-01-19 17:11:26,958 - INFO - SupCon Step [60/100] - Loss: 4.6506
2026-01-19 17:11:47,353 - INFO - SupCon Step [70/100] - Loss: 4.9290
2026-01-19 17:12:10,698 - INFO - SupCon Step [80/100] - Loss: 4.5417
2026-01-19 17:12:32,093 - INFO - SupCon Step [90/100] - Loss: 5.2076
2026-01-19 17:12:51,473 - INFO - SupCon Step [100/100] - Loss: 5.4430
2026-01-19 17:12:51,740 - INFO - SupCon pretraining finished. Final model saved at ./snapshots/supcon_final.pth
2026-01-19 17:12:52,016 - INFO - ===> Starting ArcFace Training Phase
2026-01-19 17:12:52,016 - INFO - Using CombinedFilesDataset with roots: ['d:/Done,Toreview/Image Classification/data']
2026-01-19 17:12:52,036 - INFO - Creating loader from JSON: d:/Done,Toreview/Image Classification/data/Dataset_Final_Aug/dataset_aug_metadata.json
2026-01-19 17:12:53,505 - INFO - JsonDataset loaded 617837 images. Classes: {'organic': 0, 'other': 1, 'paper': 2, 'plastic': 3}
2026-01-19 17:12:53,505 - INFO - Splitting dataset: Train=494271, Val=61783, Test=61783
2026-01-19 17:12:55,031 - INFO - JsonDataset loaded 617837 images. Classes: {'organic': 0, 'other': 1, 'paper': 2, 'plastic': 3}
2026-01-19 17:12:56,605 - INFO - JsonDataset loaded 617837 images. Classes: {'organic': 0, 'other': 1, 'paper': 2, 'plastic': 3}
2026-01-19 17:12:58,150 - INFO - JsonDataset loaded 617837 images. Classes: {'organic': 0, 'other': 1, 'paper': 2, 'plastic': 3}
2026-01-19 17:12:58,151 - INFO - Created independent Subsets: Train(494271), Val(61783), Test(61783)
2026-01-19 17:12:58,634 - INFO - WeightedRandomSampler enabled. Class counts: [ 79224 225438 118240  71369]
2026-01-19 17:12:58,743 - ERROR - Phase arcface failed: float() argument must be a string or a real number, not 'NoneType'
2026-01-19 17:12:58,744 - ERROR - Traceback (most recent call last):
  File "D:\Done,Toreview\Image Classification\pipeline\run_pipeline.py", line 445, in run_pipeline
    runner()
  File "D:\Done,Toreview\Image Classification\pipeline\run_pipeline.py", line 433, in <lambda>
    "arcface": lambda: run_arcface_phase(cfg), # Pass full cfg to arcface runner to access 'dataset'
  File "D:\Done,Toreview\Image Classification\pipeline\run_pipeline.py", line 125, in run_arcface_phase
    ema_decay=float(get_cfg("ema_decay", 0.9995)),
TypeError: float() argument must be a string or a real number, not 'NoneType'


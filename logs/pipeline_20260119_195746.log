2026-01-19 19:57:46,973 - INFO - Loading config from: configs/garbage_edge.yaml
2026-01-19 19:57:46,981 - INFO - ===> Starting ArcFace Training Phase
2026-01-19 19:57:46,982 - INFO - Using CombinedFilesDataset with roots: ['./data']
2026-01-19 19:57:46,987 - INFO - Creating loader from JSON: ./data/Dataset_Final_Aug/dataset_aug_metadata.json
2026-01-19 19:57:48,376 - INFO - JsonDataset loaded 617837 images. Classes: {'organic': 0, 'other': 1, 'paper': 2, 'plastic': 3}
2026-01-19 19:57:48,378 - INFO - Splitting dataset: Train=494271, Val=61783, Test=61783
2026-01-19 19:57:49,671 - INFO - JsonDataset loaded 617837 images. Classes: {'organic': 0, 'other': 1, 'paper': 2, 'plastic': 3}
2026-01-19 19:57:50,846 - INFO - JsonDataset loaded 617837 images. Classes: {'organic': 0, 'other': 1, 'paper': 2, 'plastic': 3}
2026-01-19 19:57:51,966 - INFO - JsonDataset loaded 617837 images. Classes: {'organic': 0, 'other': 1, 'paper': 2, 'plastic': 3}
2026-01-19 19:57:51,967 - INFO - Created independent Subsets: Train(494271), Val(61783), Test(61783)
2026-01-19 19:57:52,503 - INFO - WeightedRandomSampler enabled. Class counts: [ 79224 225438 118240  71369]
2026-01-19 19:57:53,022 - INFO - Loading pretrained weights from Hugging Face hub (timm/resnet18.a1_in1k)
2026-01-19 19:57:53,402 - INFO - [timm/resnet18.a1_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2026-01-19 19:57:53,608 - INFO - HybridBackbone Dimensions Detected -> CNN: 512, ViT: 0
2026-01-19 19:57:53,611 - INFO - CBAM initialized with channels: 512
2026-01-19 19:57:53,754 - INFO - Initialized AdaFace Loss (Adaptive Margin for low-quality images).
2026-01-19 19:59:01,895 - INFO - Step 100: Flushing GPU Memory to prevent fragmentation...
2026-01-19 19:59:59,161 - INFO - Validation loss decreased (inf --> 29.957139).  Saving model ...
2026-01-19 19:59:59,252 - INFO - Epoch 1 Step [100/30892] - Loss: 31.0663 - Acc: 12.50% - ValLoss: 29.9571 - Patience: 0/10
2026-01-19 20:00:23,206 - INFO - Step 200: Flushing GPU Memory to prevent fragmentation...
2026-01-19 20:01:17,188 - INFO - EarlyStopping counter: 1 out of 10
2026-01-19 20:01:17,188 - INFO - Epoch 1 Step [200/30892] - Loss: 14.4129 - Acc: 12.50% - ValLoss: 31.1364 - Patience: 1/10
2026-01-19 20:01:38,166 - INFO - Step 300: Flushing GPU Memory to prevent fragmentation...
2026-01-19 20:02:32,129 - INFO - Validation loss decreased (29.957139 --> 25.118575).  Saving model ...
2026-01-19 20:02:32,231 - INFO - Epoch 1 Step [300/30892] - Loss: 15.0817 - Acc: 12.50% - ValLoss: 25.1186 - Patience: 0/10
2026-01-19 20:02:53,278 - INFO - Step 400: Flushing GPU Memory to prevent fragmentation...
2026-01-19 20:03:47,536 - INFO - EarlyStopping counter: 1 out of 10
2026-01-19 20:03:47,537 - INFO - Epoch 1 Step [400/30892] - Loss: 10.5180 - Acc: 37.50% - ValLoss: 26.1148 - Patience: 1/10
2026-01-19 20:04:09,387 - INFO - Step 500: Flushing GPU Memory to prevent fragmentation...
2026-01-19 20:05:09,472 - INFO - Validation loss decreased (25.118575 --> 24.383364).  Saving model ...
2026-01-19 20:05:09,559 - INFO - Epoch 1 Step [500/30892] - Loss: 30.7754 - Acc: 12.50% - ValLoss: 24.3834 - Patience: 0/10
2026-01-19 20:05:30,599 - INFO - Step 600: Flushing GPU Memory to prevent fragmentation...
2026-01-19 20:06:23,352 - INFO - Validation loss decreased (24.383364 --> 22.561067).  Saving model ...
2026-01-19 20:06:23,434 - INFO - Epoch 1 Step [600/30892] - Loss: 19.5057 - Acc: 18.75% - ValLoss: 22.5611 - Patience: 0/10

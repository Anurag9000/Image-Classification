2026-01-24 23:16:14,262 - INFO - Global stdout/stderr redirection enabled. All prints will now appear in logs.
2026-01-24 23:16:14,262 - INFO - Loading config from: configs/garbage_tiny_direct.yaml
2026-01-24 23:16:14,268 - INFO - ===> Starting SupCon Pretraining Phase
2026-01-24 23:16:14,352 - INFO - JsonDataset loaded 56167 images. Classes: 4
2026-01-24 23:16:15,030 - INFO - SupCon Split - Train: 50556, Val: 5611
2026-01-24 23:16:15,364 - INFO - Loading pretrained weights from Hugging Face hub (timm/mobilenetv3_large_100.ra_in1k)
2026-01-24 23:16:15,699 - INFO - [timm/mobilenetv3_large_100.ra_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2026-01-24 23:16:15,780 - INFO - Detected MobileNetV3-style backbone. Injecting Interleaved CBAM...
2026-01-24 23:16:15,830 - WARNING - No activation found in stem (checked act1, act). Skipping.
2026-01-24 23:16:16,104 - INFO - Successfully injected 7 CBAM modules into MobileNetV3 blocks.
2026-01-24 23:16:16,355 - INFO - HybridBackbone Dimensions Detected -> CNN: 1280, ViT: 0
2026-01-24 23:16:16,637 - INFO - [DEBUG] Optimizer Initialized.
2026-01-24 23:16:16,727 - INFO - [DEBUG] Data Iterator Created. Entering Loop...
2026-01-24 23:16:16,727 - INFO - [TRACE] Step 0: Requesting next batch...
2026-01-24 23:16:18,754 - INFO - [TRACE] Step 0: Batch Loaded.
2026-01-24 23:16:18,819 - INFO - [TRACE] Step 0: Data moved to GPU.
2026-01-24 23:16:36,105 - ERROR - C:\Users\DELL\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\optim\lr_scheduler.py:227: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
2026-01-24 23:16:36,107 - ERROR -   warnings.warn(
2026-01-24 23:16:36,141 - INFO - [HEARTBEAT-SUPCON] Step 0/5000 (Loss: 7.1120)
2026-01-24 23:16:36,141 - INFO - [TRACE] Step 1: Requesting next batch...
2026-01-24 23:16:37,879 - INFO - [TRACE] Step 1: Batch Loaded.
2026-01-24 23:16:37,935 - INFO - [TRACE] Step 1: Data moved to GPU.
2026-01-24 23:16:49,914 - INFO - [TRACE] Step 2: Requesting next batch...
2026-01-24 23:16:52,807 - INFO - [TRACE] Step 2: Batch Loaded.
2026-01-24 23:16:52,873 - INFO - [TRACE] Step 2: Data moved to GPU.
2026-01-24 23:17:02,307 - INFO - [TRACE] Step 3: Requesting next batch...
2026-01-24 23:17:03,698 - INFO - [TRACE] Step 3: Batch Loaded.
2026-01-24 23:17:03,750 - INFO - [TRACE] Step 3: Data moved to GPU.
2026-01-24 23:17:12,180 - INFO - [TRACE] Step 4: Requesting next batch...
2026-01-24 23:17:14,836 - INFO - [TRACE] Step 4: Batch Loaded.
2026-01-24 23:17:14,891 - INFO - [TRACE] Step 4: Data moved to GPU.
2026-01-24 23:17:24,682 - INFO - [TRACE] Step 5: Requesting next batch...
2026-01-24 23:17:27,030 - INFO - [TRACE] Step 5: Batch Loaded.
2026-01-24 23:17:27,117 - INFO - [TRACE] Step 5: Data moved to GPU.
2026-01-24 23:17:35,298 - INFO - [TRACE] Step 6: Requesting next batch...
2026-01-24 23:17:37,792 - INFO - [TRACE] Step 6: Batch Loaded.
2026-01-24 23:17:37,861 - INFO - [TRACE] Step 6: Data moved to GPU.
2026-01-24 23:17:46,211 - INFO - [TRACE] Step 7: Requesting next batch...
2026-01-24 23:17:48,497 - INFO - [TRACE] Step 7: Batch Loaded.
2026-01-24 23:17:48,549 - INFO - [TRACE] Step 7: Data moved to GPU.
2026-01-24 23:17:56,684 - INFO - [TRACE] Step 8: Requesting next batch...
2026-01-24 23:18:05,177 - INFO - [TRACE] Step 8: Batch Loaded.
2026-01-24 23:18:05,380 - INFO - [TRACE] Step 8: Data moved to GPU.
2026-01-24 23:18:14,778 - INFO - [TRACE] Step 9: Requesting next batch...
2026-01-24 23:18:21,603 - INFO - [TRACE] Step 9: Batch Loaded.
2026-01-24 23:18:21,669 - INFO - [TRACE] Step 9: Data moved to GPU.
2026-01-24 23:18:29,549 - INFO - [TRACE] Step 10: Requesting next batch...
2026-01-24 23:18:31,095 - INFO - [TRACE] Step 10: Batch Loaded.
2026-01-24 23:18:31,149 - INFO - [TRACE] Step 10: Data moved to GPU.
2026-01-24 23:18:38,784 - INFO - [HEARTBEAT-SUPCON] Step 10/5000 (Loss: 6.0913)
2026-01-24 23:18:38,785 - INFO - [TRACE] Step 11: Requesting next batch...
2026-01-24 23:18:40,124 - INFO - [TRACE] Step 11: Batch Loaded.
2026-01-24 23:18:40,173 - INFO - [TRACE] Step 11: Data moved to GPU.
2026-01-24 23:18:47,803 - INFO - [TRACE] Step 12: Requesting next batch...
2026-01-24 23:18:49,004 - INFO - [TRACE] Step 12: Batch Loaded.
2026-01-24 23:18:49,052 - INFO - [TRACE] Step 12: Data moved to GPU.
2026-01-24 23:18:56,654 - INFO - [TRACE] Step 13: Requesting next batch...
2026-01-24 23:18:57,919 - INFO - [TRACE] Step 13: Batch Loaded.
2026-01-24 23:18:57,966 - INFO - [TRACE] Step 13: Data moved to GPU.
2026-01-24 23:19:05,575 - INFO - [TRACE] Step 14: Requesting next batch...
2026-01-24 23:19:06,933 - INFO - [TRACE] Step 14: Batch Loaded.
2026-01-24 23:19:06,982 - INFO - [TRACE] Step 14: Data moved to GPU.
2026-01-24 23:19:14,587 - INFO - [TRACE] Step 15: Requesting next batch...
2026-01-24 23:19:15,686 - INFO - [TRACE] Step 15: Batch Loaded.
2026-01-24 23:19:15,734 - INFO - [TRACE] Step 15: Data moved to GPU.
2026-01-24 23:19:23,337 - INFO - [TRACE] Step 16: Requesting next batch...
2026-01-24 23:19:24,531 - INFO - [TRACE] Step 16: Batch Loaded.
2026-01-24 23:19:24,579 - INFO - [TRACE] Step 16: Data moved to GPU.
2026-01-24 23:19:32,181 - INFO - [TRACE] Step 17: Requesting next batch...
2026-01-24 23:19:33,463 - INFO - [TRACE] Step 17: Batch Loaded.
2026-01-24 23:19:33,512 - INFO - [TRACE] Step 17: Data moved to GPU.
2026-01-24 23:19:41,109 - INFO - [TRACE] Step 18: Requesting next batch...
2026-01-24 23:19:42,358 - INFO - [TRACE] Step 18: Batch Loaded.
2026-01-24 23:19:42,406 - INFO - [TRACE] Step 18: Data moved to GPU.
2026-01-24 23:19:50,012 - INFO - [TRACE] Step 19: Requesting next batch...
2026-01-24 23:19:51,279 - INFO - [TRACE] Step 19: Batch Loaded.
2026-01-24 23:19:51,329 - INFO - [TRACE] Step 19: Data moved to GPU.
2026-01-24 23:19:58,938 - INFO - [TRACE] Step 20: Requesting next batch...
2026-01-24 23:20:00,124 - INFO - [TRACE] Step 20: Batch Loaded.
2026-01-24 23:20:00,174 - INFO - [TRACE] Step 20: Data moved to GPU.
2026-01-24 23:20:07,805 - INFO - [HEARTBEAT-SUPCON] Step 20/5000 (Loss: 5.9222)
2026-01-24 23:20:07,806 - INFO - [TRACE] Step 21: Requesting next batch...
2026-01-24 23:20:09,007 - INFO - [TRACE] Step 21: Batch Loaded.
2026-01-24 23:20:09,056 - INFO - [TRACE] Step 21: Data moved to GPU.
2026-01-24 23:20:16,649 - INFO - [TRACE] Step 22: Requesting next batch...
2026-01-24 23:20:17,793 - INFO - [TRACE] Step 22: Batch Loaded.
2026-01-24 23:20:17,842 - INFO - [TRACE] Step 22: Data moved to GPU.
2026-01-24 23:20:25,443 - INFO - [TRACE] Step 23: Requesting next batch...
2026-01-24 23:20:26,688 - INFO - [TRACE] Step 23: Batch Loaded.
2026-01-24 23:20:26,737 - INFO - [TRACE] Step 23: Data moved to GPU.
2026-01-24 23:20:34,414 - INFO - [TRACE] Step 24: Requesting next batch...
2026-01-24 23:20:35,643 - INFO - [TRACE] Step 24: Batch Loaded.
2026-01-24 23:20:35,692 - INFO - [TRACE] Step 24: Data moved to GPU.
2026-01-24 23:20:43,318 - INFO - [TRACE] Step 25: Requesting next batch...
2026-01-24 23:20:44,472 - INFO - [TRACE] Step 25: Batch Loaded.
2026-01-24 23:20:44,522 - INFO - [TRACE] Step 25: Data moved to GPU.
2026-01-24 23:20:52,145 - INFO - [TRACE] Step 26: Requesting next batch...
2026-01-24 23:20:53,460 - INFO - [TRACE] Step 26: Batch Loaded.
2026-01-24 23:20:53,509 - INFO - [TRACE] Step 26: Data moved to GPU.
2026-01-24 23:21:01,924 - INFO - [TRACE] Step 27: Requesting next batch...
2026-01-24 23:21:03,725 - INFO - [TRACE] Step 27: Batch Loaded.
2026-01-24 23:21:03,774 - INFO - [TRACE] Step 27: Data moved to GPU.
2026-01-24 23:21:14,173 - INFO - [TRACE] Step 28: Requesting next batch...
2026-01-24 23:21:15,951 - INFO - [TRACE] Step 28: Batch Loaded.
2026-01-24 23:21:16,003 - INFO - [TRACE] Step 28: Data moved to GPU.
2026-01-24 23:21:25,862 - INFO - [TRACE] Step 29: Requesting next batch...
2026-01-24 23:21:27,729 - INFO - [TRACE] Step 29: Batch Loaded.
2026-01-24 23:21:27,781 - INFO - [TRACE] Step 29: Data moved to GPU.
2026-01-24 23:21:37,072 - INFO - [TRACE] Step 30: Requesting next batch...
2026-01-24 23:21:40,028 - INFO - [TRACE] Step 30: Batch Loaded.
2026-01-24 23:21:40,085 - INFO - [TRACE] Step 30: Data moved to GPU.
2026-01-24 23:21:50,974 - INFO - [HEARTBEAT-SUPCON] Step 30/5000 (Loss: 6.0765)
2026-01-24 23:21:50,991 - INFO - [TRACE] Step 31: Requesting next batch...
2026-01-24 23:21:58,003 - INFO - [TRACE] Step 31: Batch Loaded.
2026-01-24 23:21:58,061 - INFO - [TRACE] Step 31: Data moved to GPU.
2026-01-24 23:22:10,011 - INFO - [TRACE] Step 32: Requesting next batch...
2026-01-24 23:22:17,669 - INFO - [TRACE] Step 32: Batch Loaded.
2026-01-24 23:22:17,744 - INFO - [TRACE] Step 32: Data moved to GPU.
2026-01-24 23:22:30,108 - INFO - [TRACE] Step 33: Requesting next batch...
2026-01-24 23:22:37,021 - INFO - [TRACE] Step 33: Batch Loaded.
2026-01-24 23:22:37,142 - INFO - [TRACE] Step 33: Data moved to GPU.
2026-01-24 23:22:48,535 - INFO - [TRACE] Step 34: Requesting next batch...
2026-01-24 23:22:58,307 - INFO - [TRACE] Step 34: Batch Loaded.
2026-01-24 23:22:58,385 - INFO - [TRACE] Step 34: Data moved to GPU.
2026-01-24 23:23:08,199 - INFO - [TRACE] Step 35: Requesting next batch...
2026-01-24 23:23:11,128 - INFO - [TRACE] Step 35: Batch Loaded.
2026-01-24 23:23:11,179 - INFO - [TRACE] Step 35: Data moved to GPU.
2026-01-24 23:23:19,951 - INFO - [TRACE] Step 36: Requesting next batch...
2026-01-24 23:23:23,811 - INFO - [TRACE] Step 36: Batch Loaded.
2026-01-24 23:23:23,871 - INFO - [TRACE] Step 36: Data moved to GPU.
2026-01-24 23:23:33,677 - INFO - [TRACE] Step 37: Requesting next batch...
2026-01-24 23:23:43,831 - INFO - [TRACE] Step 37: Batch Loaded.
2026-01-24 23:23:44,441 - INFO - [TRACE] Step 37: Data moved to GPU.
2026-01-24 23:23:49,175 - ERROR - Phase supcon failed: cuDNN error: CUDNN_STATUS_INTERNAL_ERROR
2026-01-24 23:23:49,413 - ERROR - Traceback (most recent call last):
  File "D:\Done,Toreview\Image Classification\pipeline\run_pipeline.py", line 585, in <module>
    runner()
  File "D:\Done,Toreview\Image Classification\pipeline\run_pipeline.py", line 572, in <lambda>
    "supcon": lambda: run_supcon_phase(cfg),
  File "D:\Done,Toreview\Image Classification\pipeline\run_pipeline.py", line 105, in run_supcon_phase
    SupConPretrainer(loader, val_loader, supcon_cfg).train()
  File "D:\Done,Toreview\Image Classification\pipeline\train_supcon.py", line 211, in train
    self.scaler.scale(loss).backward()
  File "C:\Users\DELL\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "C:\Users\DELL\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\autograd\__init__.py", line 347, in backward
    _engine_run_backward(
  File "C:\Users\DELL\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\autograd\graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
RuntimeError: cuDNN error: CUDNN_STATUS_INTERNAL_ERROR

2026-01-24 23:23:49,484 - ERROR - Traceback (most recent call last):
2026-01-24 23:23:49,498 - ERROR -   File "C:\Users\DELL\AppData\Local\Programs\Python\Python310\lib\runpy.py", line 196, in _run_module_as_main
2026-01-24 23:23:49,602 - ERROR - return _run_code(code, main_globals, None,
2026-01-24 23:23:49,623 - ERROR -   File "C:\Users\DELL\AppData\Local\Programs\Python\Python310\lib\runpy.py", line 86, in _run_code
2026-01-24 23:23:49,625 - ERROR - exec(code, run_globals)
2026-01-24 23:23:49,626 - ERROR -   File "D:\Done,Toreview\Image Classification\pipeline\run_pipeline.py", line 585, in <module>
2026-01-24 23:23:49,634 - ERROR - runner()
2026-01-24 23:23:49,634 - ERROR -   File "D:\Done,Toreview\Image Classification\pipeline\run_pipeline.py", line 572, in <lambda>
2026-01-24 23:23:49,635 - ERROR - "supcon": lambda: run_supcon_phase(cfg),
2026-01-24 23:23:49,636 - ERROR -   File "D:\Done,Toreview\Image Classification\pipeline\run_pipeline.py", line 105, in run_supcon_phase
2026-01-24 23:23:49,640 - ERROR - SupConPretrainer(loader, val_loader, supcon_cfg).train()
2026-01-24 23:23:49,641 - ERROR -   File "D:\Done,Toreview\Image Classification\pipeline\train_supcon.py", line 211, in train
2026-01-24 23:23:49,645 - ERROR - self.scaler.scale(loss).backward()
2026-01-24 23:23:49,646 - ERROR -   File "C:\Users\DELL\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\_tensor.py", line 626, in backward
2026-01-24 23:23:49,651 - ERROR - torch.autograd.backward(
2026-01-24 23:23:49,652 - ERROR -   File "C:\Users\DELL\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\autograd\__init__.py", line 347, in backward
2026-01-24 23:23:49,656 - ERROR - _engine_run_backward(
2026-01-24 23:23:49,659 - ERROR -   File "C:\Users\DELL\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\autograd\graph.py", line 823, in _engine_run_backward
2026-01-24 23:23:49,661 - ERROR - return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
2026-01-24 23:23:49,723 - ERROR - RuntimeError
2026-01-24 23:23:49,734 - ERROR - :
2026-01-24 23:23:49,735 - ERROR - cuDNN error: CUDNN_STATUS_INTERNAL_ERROR

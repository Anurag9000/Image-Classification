2026-01-20 19:05:11,108 - INFO - Loading config from: configs/garbage_edge.yaml
2026-01-20 19:05:11,117 - INFO - ===> Starting ArcFace Training Phase
2026-01-20 19:05:11,117 - INFO - Override: Resuming from snapshots_teacher/latest_checkpoint.pth
2026-01-20 19:05:11,118 - INFO - Using CombinedFilesDataset with roots: ['./data']
2026-01-20 19:05:11,125 - INFO - Creating loader from JSON: ./data/Dataset_Final_Aug/dataset_aug_metadata.json
2026-01-20 19:05:12,730 - INFO - Total images in JSON: 617837
2026-01-20 19:05:12,731 - INFO - Splitting dataset: Train=494271, Val=61783, Test=61783
2026-01-20 19:05:13,224 - INFO - JsonDataset loaded 494271 images. Classes: {'organic': 0, 'other': 1, 'paper': 2, 'plastic': 3}
2026-01-20 19:05:13,252 - INFO - JsonDataset loaded 61783 images. Classes: {'organic': 0, 'other': 1, 'paper': 2, 'plastic': 3}
2026-01-20 19:05:13,300 - INFO - JsonDataset loaded 61783 images. Classes: {'organic': 0, 'other': 1, 'paper': 2, 'plastic': 3}
2026-01-20 19:05:13,302 - INFO - Created RAM-Optimized Datasets: Train(494271), Val(61783), Test(61783)
2026-01-20 19:05:13,673 - INFO - WeightedRandomSampler enabled. Class counts: [ 79224 225438 118240  71369]
2026-01-20 19:05:14,117 - INFO - Loading pretrained weights from Hugging Face hub (timm/resnet18.a1_in1k)
2026-01-20 19:05:14,467 - INFO - [timm/resnet18.a1_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2026-01-20 19:05:14,671 - INFO - HybridBackbone Dimensions Detected -> CNN: 512, ViT: 0
2026-01-20 19:05:14,673 - INFO - CBAM initialized with channels: 512
2026-01-20 19:05:14,925 - INFO - Loading SupCon weights from ./snapshots/supcon_final_best.pth...
2026-01-20 19:05:15,089 - INFO - SupCon weights loaded successfully.
2026-01-20 19:05:15,095 - INFO - Initialized AdaFace Loss (Adaptive Margin for low-quality images).
2026-01-20 19:05:15,096 - INFO - RESUMING TRAINING from snapshots_teacher/latest_checkpoint.pth
2026-01-20 19:05:15,471 - INFO - Successfully resumed from Epoch 1, Step 4439
2026-01-20 19:05:18,461 - INFO - Epoch 1 Step [4440/30892] - Loss: 27.7665 - Acc: 43.75% - ValLoss: N/A - Patience: N/A
2026-01-20 19:05:30,155 - INFO - Epoch 1 Step [4450/30892] - Loss: 17.8852 - Acc: 31.25% - ValLoss: N/A - Patience: N/A
2026-01-20 19:05:39,610 - INFO - Epoch 1 Step [4460/30892] - Loss: 23.1607 - Acc: 56.25% - ValLoss: N/A - Patience: N/A
2026-01-20 19:05:47,786 - INFO - Epoch 1 Step [4470/30892] - Loss: 20.9793 - Acc: 43.75% - ValLoss: N/A - Patience: N/A
2026-01-20 19:05:56,858 - INFO - Epoch 1 Step [4480/30892] - Loss: 11.5915 - Acc: 18.75% - ValLoss: N/A - Patience: N/A
2026-01-20 19:06:04,642 - INFO - Epoch 1 Step [4490/30892] - Loss: 10.0383 - Acc: 43.75% - ValLoss: N/A - Patience: N/A
2026-01-20 19:06:25,740 - INFO - Validation loss decreased (inf --> 24.081067).  Saving model ...
2026-01-20 19:06:25,832 - INFO - Epoch 1 Step [4500/30892] - Loss: 18.6376 - Acc: 43.75% - ValLoss: 24.0811 - Patience: 0/50
2026-01-20 19:06:35,557 - INFO - Epoch 1 Step [4510/30892] - Loss: 7.2775 - Acc: 18.75% - ValLoss: N/A - Patience: N/A
2026-01-20 19:06:46,588 - INFO - Epoch 1 Step [4520/30892] - Loss: 15.9631 - Acc: 50.00% - ValLoss: N/A - Patience: N/A
2026-01-20 19:06:54,708 - INFO - Epoch 1 Step [4530/30892] - Loss: 24.1465 - Acc: 43.75% - ValLoss: N/A - Patience: N/A
2026-01-20 19:07:03,006 - INFO - Epoch 1 Step [4540/30892] - Loss: 7.8263 - Acc: 31.25% - ValLoss: N/A - Patience: N/A
2026-01-20 19:07:11,728 - INFO - Epoch 1 Step [4550/30892] - Loss: 8.7047 - Acc: 37.50% - ValLoss: N/A - Patience: N/A
2026-01-20 19:07:20,490 - INFO - Epoch 1 Step [4560/30892] - Loss: 24.6966 - Acc: 50.00% - ValLoss: N/A - Patience: N/A
2026-01-20 19:07:29,572 - INFO - Epoch 1 Step [4570/30892] - Loss: 6.0329 - Acc: 25.00% - ValLoss: N/A - Patience: N/A
2026-01-20 19:07:37,970 - INFO - Epoch 1 Step [4580/30892] - Loss: 7.2686 - Acc: 37.50% - ValLoss: N/A - Patience: N/A
2026-01-20 19:07:45,917 - INFO - Epoch 1 Step [4590/30892] - Loss: 5.7545 - Acc: 18.75% - ValLoss: N/A - Patience: N/A
2026-01-20 19:07:54,719 - INFO - Epoch 1 Step [4600/30892] - Loss: 19.1385 - Acc: 56.25% - ValLoss: N/A - Patience: N/A
2026-01-20 19:08:02,217 - INFO - Epoch 1 Step [4610/30892] - Loss: 21.7923 - Acc: 37.50% - ValLoss: N/A - Patience: N/A
2026-01-20 19:08:09,834 - INFO - Epoch 1 Step [4620/30892] - Loss: 13.8058 - Acc: 43.75% - ValLoss: N/A - Patience: N/A
2026-01-20 19:08:17,498 - INFO - Epoch 1 Step [4630/30892] - Loss: 5.3994 - Acc: 43.75% - ValLoss: N/A - Patience: N/A
2026-01-20 19:08:25,134 - INFO - Epoch 1 Step [4640/30892] - Loss: 12.9703 - Acc: 50.00% - ValLoss: N/A - Patience: N/A
2026-01-20 19:08:32,654 - INFO - Epoch 1 Step [4650/30892] - Loss: 6.8759 - Acc: 18.75% - ValLoss: N/A - Patience: N/A
2026-01-20 19:08:40,419 - INFO - Epoch 1 Step [4660/30892] - Loss: 27.9849 - Acc: 18.75% - ValLoss: N/A - Patience: N/A
2026-01-20 19:08:48,057 - INFO - Epoch 1 Step [4670/30892] - Loss: 25.5009 - Acc: 43.75% - ValLoss: N/A - Patience: N/A
2026-01-20 19:08:56,005 - INFO - Epoch 1 Step [4680/30892] - Loss: 21.9024 - Acc: 37.50% - ValLoss: N/A - Patience: N/A
2026-01-20 19:09:03,949 - INFO - Epoch 1 Step [4690/30892] - Loss: 29.4572 - Acc: 37.50% - ValLoss: N/A - Patience: N/A
2026-01-20 19:09:11,833 - INFO - Epoch 1 Step [4700/30892] - Loss: 10.8957 - Acc: 25.00% - ValLoss: N/A - Patience: N/A
2026-01-20 19:09:19,791 - INFO - Epoch 1 Step [4710/30892] - Loss: 19.1515 - Acc: 62.50% - ValLoss: N/A - Patience: N/A
2026-01-20 19:09:27,582 - INFO - Epoch 1 Step [4720/30892] - Loss: 24.7179 - Acc: 56.25% - ValLoss: N/A - Patience: N/A
2026-01-20 19:09:35,365 - INFO - Epoch 1 Step [4730/30892] - Loss: 4.9097 - Acc: 31.25% - ValLoss: N/A - Patience: N/A
2026-01-20 19:09:43,031 - INFO - Epoch 1 Step [4740/30892] - Loss: 4.7089 - Acc: 18.75% - ValLoss: N/A - Patience: N/A
2026-01-20 19:09:50,971 - INFO - Epoch 1 Step [4750/30892] - Loss: 4.5641 - Acc: 12.50% - ValLoss: N/A - Patience: N/A
2026-01-20 19:09:58,814 - INFO - Epoch 1 Step [4760/30892] - Loss: 21.8420 - Acc: 56.25% - ValLoss: N/A - Patience: N/A
2026-01-20 19:10:06,595 - INFO - Epoch 1 Step [4770/30892] - Loss: 10.0097 - Acc: 25.00% - ValLoss: N/A - Patience: N/A
2026-01-20 19:10:14,330 - INFO - Epoch 1 Step [4780/30892] - Loss: 9.9276 - Acc: 12.50% - ValLoss: N/A - Patience: N/A
2026-01-20 19:10:22,091 - INFO - Epoch 1 Step [4790/30892] - Loss: 2.3426 - Acc: 18.75% - ValLoss: N/A - Patience: N/A
2026-01-20 19:10:30,366 - INFO - Epoch 1 Step [4800/30892] - Loss: 26.3839 - Acc: 50.00% - ValLoss: N/A - Patience: N/A
2026-01-20 19:10:38,228 - INFO - Epoch 1 Step [4810/30892] - Loss: 17.6071 - Acc: 31.25% - ValLoss: N/A - Patience: N/A
2026-01-20 19:10:46,548 - INFO - Epoch 1 Step [4820/30892] - Loss: 9.5926 - Acc: 37.50% - ValLoss: N/A - Patience: N/A
2026-01-20 19:10:57,380 - INFO - Epoch 1 Step [4830/30892] - Loss: 14.1765 - Acc: 18.75% - ValLoss: N/A - Patience: N/A
2026-01-20 19:11:05,382 - INFO - Epoch 1 Step [4840/30892] - Loss: 23.7560 - Acc: 50.00% - ValLoss: N/A - Patience: N/A
2026-01-20 19:11:13,625 - INFO - Epoch 1 Step [4850/30892] - Loss: 9.0910 - Acc: 18.75% - ValLoss: N/A - Patience: N/A
2026-01-20 19:11:21,815 - INFO - Epoch 1 Step [4860/30892] - Loss: 25.2012 - Acc: 31.25% - ValLoss: N/A - Patience: N/A
2026-01-20 19:11:29,611 - INFO - Epoch 1 Step [4870/30892] - Loss: 11.9311 - Acc: 25.00% - ValLoss: N/A - Patience: N/A
2026-01-20 19:11:37,671 - INFO - Epoch 1 Step [4880/30892] - Loss: 24.6021 - Acc: 43.75% - ValLoss: N/A - Patience: N/A

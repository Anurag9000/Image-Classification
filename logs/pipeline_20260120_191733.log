2026-01-20 19:17:33,458 - INFO - Loading config from: configs/garbage_edge.yaml
2026-01-20 19:17:33,470 - INFO - ===> Starting ArcFace Training Phase
2026-01-20 19:17:33,471 - INFO - Override: Resuming from snapshots_teacher/latest_checkpoint.pth
2026-01-20 19:17:33,471 - INFO - Using CombinedFilesDataset with roots: ['./data']
2026-01-20 19:17:33,474 - INFO - Creating loader from JSON: ./data/Dataset_Final_Aug/dataset_aug_metadata.json
2026-01-20 19:17:35,123 - INFO - Total images in JSON: 617837
2026-01-20 19:17:35,125 - INFO - Splitting dataset: Train=494271, Val=61783, Test=61783
2026-01-20 19:17:35,709 - INFO - JsonDataset loaded 494271 images. Classes: {'organic': 0, 'other': 1, 'paper': 2, 'plastic': 3}
2026-01-20 19:17:35,743 - INFO - JsonDataset loaded 61783 images. Classes: {'organic': 0, 'other': 1, 'paper': 2, 'plastic': 3}
2026-01-20 19:17:35,773 - INFO - JsonDataset loaded 61783 images. Classes: {'organic': 0, 'other': 1, 'paper': 2, 'plastic': 3}
2026-01-20 19:17:35,774 - INFO - Created RAM-Optimized Datasets: Train(494271), Val(61783), Test(61783)
2026-01-20 19:17:36,478 - INFO - WeightedRandomSampler enabled. Class counts: [ 79224 225438 118240  71369]
2026-01-20 19:17:37,335 - INFO - Loading pretrained weights from Hugging Face hub (timm/resnet18.a1_in1k)
2026-01-20 19:17:38,173 - INFO - [timm/resnet18.a1_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2026-01-20 19:17:38,520 - INFO - HybridBackbone Dimensions Detected -> CNN: 512, ViT: 0
2026-01-20 19:17:38,522 - INFO - CBAM initialized with channels: 512
2026-01-20 19:17:39,088 - INFO - Loading SupCon weights from ./snapshots/supcon_final_best.pth...
2026-01-20 19:17:39,504 - INFO - SupCon weights loaded successfully.
2026-01-20 19:17:39,512 - INFO - Initialized AdaFace Loss (Adaptive Margin for low-quality images).
2026-01-20 19:17:39,520 - INFO - RESUMING TRAINING from snapshots_teacher/latest_checkpoint.pth
2026-01-20 19:17:40,325 - INFO - Successfully resumed from Epoch 1, Step 4879
2026-01-20 19:17:43,875 - INFO - Epoch 1 Step [4880/30892] - Loss: 12.5251 - Acc: 31.25% - ValLoss: N/A - Patience: N/A
2026-01-20 19:17:56,712 - INFO - Epoch 1 Step [4890/30892] - Loss: 13.2182 - Acc: 12.50% - ValLoss: N/A - Patience: N/A
2026-01-20 19:18:05,134 - INFO - Epoch 1 Step [4900/30892] - Loss: 10.4406 - Acc: 37.50% - ValLoss: N/A - Patience: N/A
2026-01-20 19:18:15,127 - INFO - Epoch 1 Step [4910/30892] - Loss: 7.4757 - Acc: 18.75% - ValLoss: N/A - Patience: N/A
2026-01-20 19:18:33,574 - INFO - Epoch 1 Step [4920/30892] - Loss: 18.9998 - Acc: 37.50% - ValLoss: N/A - Patience: N/A
2026-01-20 19:18:41,645 - INFO - Epoch 1 Step [4930/30892] - Loss: 9.9773 - Acc: 43.75% - ValLoss: N/A - Patience: N/A
2026-01-20 19:18:50,212 - INFO - Epoch 1 Step [4940/30892] - Loss: 29.0895 - Acc: 25.00% - ValLoss: N/A - Patience: N/A
2026-01-20 19:19:01,241 - INFO - Epoch 1 Step [4950/30892] - Loss: 11.9476 - Acc: 31.25% - ValLoss: N/A - Patience: N/A
2026-01-20 19:19:12,038 - INFO - Epoch 1 Step [4960/30892] - Loss: 4.9748 - Acc: 37.50% - ValLoss: N/A - Patience: N/A
2026-01-20 19:19:21,969 - INFO - Epoch 1 Step [4970/30892] - Loss: 13.1292 - Acc: 37.50% - ValLoss: N/A - Patience: N/A
2026-01-20 19:19:30,480 - INFO - Epoch 1 Step [4980/30892] - Loss: 28.6542 - Acc: 43.75% - ValLoss: N/A - Patience: N/A
2026-01-20 19:19:39,224 - INFO - Epoch 1 Step [4990/30892] - Loss: 21.9777 - Acc: 25.00% - ValLoss: N/A - Patience: N/A
2026-01-20 19:20:00,375 - INFO - Validation loss decreased (inf --> 23.548696).  Saving model ...
2026-01-20 19:20:00,469 - INFO - Epoch 1 Step [5000/30892] - Loss: 19.4699 - Acc: 25.00% - ValLoss: 23.5487 - Patience: 0/50
2026-01-20 19:20:08,245 - INFO - Epoch 1 Step [5010/30892] - Loss: 12.0236 - Acc: 18.75% - ValLoss: N/A - Patience: N/A
2026-01-20 19:20:16,572 - INFO - Epoch 1 Step [5020/30892] - Loss: 21.6280 - Acc: 37.50% - ValLoss: N/A - Patience: N/A
2026-01-20 19:20:24,523 - INFO - Epoch 1 Step [5030/30892] - Loss: 14.6320 - Acc: 31.25% - ValLoss: N/A - Patience: N/A
2026-01-20 19:20:33,024 - INFO - Epoch 1 Step [5040/30892] - Loss: 24.8273 - Acc: 43.75% - ValLoss: N/A - Patience: N/A
2026-01-20 19:20:41,047 - INFO - Epoch 1 Step [5050/30892] - Loss: 10.2654 - Acc: 18.75% - ValLoss: N/A - Patience: N/A
2026-01-20 19:20:50,291 - INFO - Epoch 1 Step [5060/30892] - Loss: 23.5315 - Acc: 43.75% - ValLoss: N/A - Patience: N/A
2026-01-20 19:20:58,055 - INFO - Epoch 1 Step [5070/30892] - Loss: 26.4767 - Acc: 43.75% - ValLoss: N/A - Patience: N/A
2026-01-20 19:21:07,570 - INFO - Epoch 1 Step [5080/30892] - Loss: 9.8515 - Acc: 25.00% - ValLoss: N/A - Patience: N/A
2026-01-20 19:21:15,520 - INFO - Epoch 1 Step [5090/30892] - Loss: 11.0732 - Acc: 37.50% - ValLoss: N/A - Patience: N/A
2026-01-20 19:21:24,094 - INFO - Epoch 1 Step [5100/30892] - Loss: 24.4063 - Acc: 31.25% - ValLoss: N/A - Patience: N/A
2026-01-20 19:22:32,294 - INFO - Epoch 1 Step [5110/30892] - Loss: 23.5281 - Acc: 50.00% - ValLoss: N/A - Patience: N/A
2026-01-20 19:22:41,971 - INFO - Epoch 1 Step [5120/30892] - Loss: 11.1459 - Acc: 31.25% - ValLoss: N/A - Patience: N/A
2026-01-20 19:22:51,466 - INFO - Epoch 1 Step [5130/30892] - Loss: 13.4621 - Acc: 43.75% - ValLoss: N/A - Patience: N/A
2026-01-20 19:22:59,393 - INFO - Epoch 1 Step [5140/30892] - Loss: 8.9508 - Acc: 25.00% - ValLoss: N/A - Patience: N/A
2026-01-20 19:23:06,884 - INFO - Epoch 1 Step [5150/30892] - Loss: 2.7204 - Acc: 31.25% - ValLoss: N/A - Patience: N/A
2026-01-20 19:23:14,295 - INFO - Epoch 1 Step [5160/30892] - Loss: 23.1342 - Acc: 56.25% - ValLoss: N/A - Patience: N/A
2026-01-20 19:23:22,070 - INFO - Epoch 1 Step [5170/30892] - Loss: 23.6623 - Acc: 31.25% - ValLoss: N/A - Patience: N/A
2026-01-20 19:23:29,651 - INFO - Epoch 1 Step [5180/30892] - Loss: 6.7882 - Acc: 25.00% - ValLoss: N/A - Patience: N/A
2026-01-20 19:23:37,202 - INFO - Epoch 1 Step [5190/30892] - Loss: 14.9244 - Acc: 25.00% - ValLoss: N/A - Patience: N/A
2026-01-20 19:23:44,925 - INFO - Epoch 1 Step [5200/30892] - Loss: 26.0841 - Acc: 50.00% - ValLoss: N/A - Patience: N/A
2026-01-20 19:23:53,486 - INFO - Epoch 1 Step [5210/30892] - Loss: 15.1426 - Acc: 31.25% - ValLoss: N/A - Patience: N/A
2026-01-20 19:24:02,336 - INFO - Epoch 1 Step [5220/30892] - Loss: 8.7603 - Acc: 18.75% - ValLoss: N/A - Patience: N/A
2026-01-20 19:24:12,172 - INFO - Epoch 1 Step [5230/30892] - Loss: 34.5760 - Acc: 56.25% - ValLoss: N/A - Patience: N/A
2026-01-20 19:24:20,040 - INFO - Epoch 1 Step [5240/30892] - Loss: 6.7250 - Acc: 12.50% - ValLoss: N/A - Patience: N/A
2026-01-20 19:24:27,846 - INFO - Epoch 1 Step [5250/30892] - Loss: 24.0941 - Acc: 43.75% - ValLoss: N/A - Patience: N/A
2026-01-20 19:24:35,756 - INFO - Epoch 1 Step [5260/30892] - Loss: 21.1121 - Acc: 37.50% - ValLoss: N/A - Patience: N/A
2026-01-20 19:24:43,997 - INFO - Epoch 1 Step [5270/30892] - Loss: 23.4809 - Acc: 75.00% - ValLoss: N/A - Patience: N/A
2026-01-20 19:24:51,796 - INFO - Epoch 1 Step [5280/30892] - Loss: 19.1417 - Acc: 43.75% - ValLoss: N/A - Patience: N/A
2026-01-20 19:24:59,623 - INFO - Epoch 1 Step [5290/30892] - Loss: 23.6193 - Acc: 31.25% - ValLoss: N/A - Patience: N/A
2026-01-20 19:25:07,917 - INFO - Epoch 1 Step [5300/30892] - Loss: 21.7499 - Acc: 50.00% - ValLoss: N/A - Patience: N/A
2026-01-20 19:25:15,582 - INFO - Epoch 1 Step [5310/30892] - Loss: 21.5534 - Acc: 50.00% - ValLoss: N/A - Patience: N/A
2026-01-20 19:25:23,056 - INFO - Epoch 1 Step [5320/30892] - Loss: 21.0055 - Acc: 43.75% - ValLoss: N/A - Patience: N/A
2026-01-20 19:25:30,907 - INFO - Epoch 1 Step [5330/30892] - Loss: 17.2464 - Acc: 43.75% - ValLoss: N/A - Patience: N/A
2026-01-20 19:25:38,599 - INFO - Epoch 1 Step [5340/30892] - Loss: 25.3413 - Acc: 62.50% - ValLoss: N/A - Patience: N/A
2026-01-20 19:25:46,021 - INFO - Epoch 1 Step [5350/30892] - Loss: 22.1913 - Acc: 12.50% - ValLoss: N/A - Patience: N/A
2026-01-20 19:25:53,736 - INFO - Epoch 1 Step [5360/30892] - Loss: 21.3255 - Acc: 50.00% - ValLoss: N/A - Patience: N/A
2026-01-20 19:26:01,456 - INFO - Epoch 1 Step [5370/30892] - Loss: 18.5210 - Acc: 43.75% - ValLoss: N/A - Patience: N/A
2026-01-20 19:26:09,527 - INFO - Epoch 1 Step [5380/30892] - Loss: 22.9172 - Acc: 37.50% - ValLoss: N/A - Patience: N/A
2026-01-20 19:26:17,477 - INFO - Epoch 1 Step [5390/30892] - Loss: 5.0855 - Acc: 18.75% - ValLoss: N/A - Patience: N/A
2026-01-20 19:26:27,573 - INFO - Epoch 1 Step [5400/30892] - Loss: 20.0423 - Acc: 31.25% - ValLoss: N/A - Patience: N/A
2026-01-20 19:26:36,873 - INFO - Epoch 1 Step [5410/30892] - Loss: 14.3825 - Acc: 43.75% - ValLoss: N/A - Patience: N/A
2026-01-20 19:26:45,619 - INFO - Epoch 1 Step [5420/30892] - Loss: 25.4574 - Acc: 37.50% - ValLoss: N/A - Patience: N/A
2026-01-20 19:26:54,620 - INFO - Epoch 1 Step [5430/30892] - Loss: 23.3672 - Acc: 31.25% - ValLoss: N/A - Patience: N/A
2026-01-20 19:27:03,462 - INFO - Epoch 1 Step [5440/30892] - Loss: 10.8223 - Acc: 18.75% - ValLoss: N/A - Patience: N/A
2026-01-20 19:27:13,682 - INFO - Epoch 1 Step [5450/30892] - Loss: 11.2550 - Acc: 50.00% - ValLoss: N/A - Patience: N/A
2026-01-20 19:27:26,807 - INFO - Epoch 1 Step [5460/30892] - Loss: 18.3814 - Acc: 43.75% - ValLoss: N/A - Patience: N/A
2026-01-20 19:27:39,421 - INFO - Epoch 1 Step [5470/30892] - Loss: 15.8984 - Acc: 37.50% - ValLoss: N/A - Patience: N/A
2026-01-20 19:27:47,940 - INFO - Epoch 1 Step [5480/30892] - Loss: 19.4762 - Acc: 68.75% - ValLoss: N/A - Patience: N/A
2026-01-20 19:27:55,540 - INFO - Epoch 1 Step [5490/30892] - Loss: 7.5289 - Acc: 25.00% - ValLoss: N/A - Patience: N/A
2026-01-20 19:28:17,291 - INFO - Validation loss decreased (23.548696 --> 22.215430).  Saving model ...
2026-01-20 19:28:17,391 - INFO - Epoch 1 Step [5500/30892] - Loss: 21.7910 - Acc: 56.25% - ValLoss: 22.2154 - Patience: 0/50
2026-01-20 19:28:26,471 - INFO - Epoch 1 Step [5510/30892] - Loss: 22.9348 - Acc: 56.25% - ValLoss: N/A - Patience: N/A
2026-01-20 19:28:39,778 - INFO - Epoch 1 Step [5520/30892] - Loss: 12.6606 - Acc: 18.75% - ValLoss: N/A - Patience: N/A
2026-01-20 19:28:51,124 - INFO - Epoch 1 Step [5530/30892] - Loss: 2.9567 - Acc: 12.50% - ValLoss: N/A - Patience: N/A
2026-01-20 19:28:59,787 - INFO - Epoch 1 Step [5540/30892] - Loss: 15.9963 - Acc: 37.50% - ValLoss: N/A - Patience: N/A
2026-01-20 19:29:08,027 - INFO - Epoch 1 Step [5550/30892] - Loss: 22.2179 - Acc: 62.50% - ValLoss: N/A - Patience: N/A
2026-01-20 19:29:17,206 - INFO - Epoch 1 Step [5560/30892] - Loss: 18.2423 - Acc: 43.75% - ValLoss: N/A - Patience: N/A
2026-01-20 19:29:24,971 - INFO - Epoch 1 Step [5570/30892] - Loss: 8.9906 - Acc: 25.00% - ValLoss: N/A - Patience: N/A
2026-01-20 19:29:36,673 - INFO - Epoch 1 Step [5580/30892] - Loss: 14.7441 - Acc: 31.25% - ValLoss: N/A - Patience: N/A
2026-01-20 19:29:50,516 - INFO - Epoch 1 Step [5590/30892] - Loss: 2.7880 - Acc: 50.00% - ValLoss: N/A - Patience: N/A

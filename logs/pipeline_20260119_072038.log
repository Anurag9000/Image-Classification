2026-01-19 07:20:38,720 - INFO - Loading config from: configs/garbage_edge.yaml
2026-01-19 07:20:38,727 - INFO - ===> Starting ArcFace Training Phase
2026-01-19 07:20:38,728 - INFO - Using CombinedFilesDataset with roots: ['d:/Done,Toreview/Image Classification/data']
2026-01-19 07:20:38,736 - INFO - Creating loader from JSON: d:/Done,Toreview/Image Classification/data/Dataset_Final_Aug/dataset_aug_metadata.json
2026-01-19 07:20:40,344 - INFO - JsonDataset loaded 617837 images. Classes: {'organic': 0, 'other': 1, 'paper': 2, 'plastic': 3}
2026-01-19 07:20:40,345 - INFO - Splitting dataset: Train=494271, Val=61783, Test=61783
2026-01-19 07:20:42,182 - INFO - JsonDataset loaded 617837 images. Classes: {'organic': 0, 'other': 1, 'paper': 2, 'plastic': 3}
2026-01-19 07:20:43,698 - INFO - JsonDataset loaded 617837 images. Classes: {'organic': 0, 'other': 1, 'paper': 2, 'plastic': 3}
2026-01-19 07:20:45,162 - INFO - JsonDataset loaded 617837 images. Classes: {'organic': 0, 'other': 1, 'paper': 2, 'plastic': 3}
2026-01-19 07:20:45,162 - INFO - Created independent Subsets: Train(494271), Val(61783), Test(61783)
2026-01-19 07:20:45,643 - INFO - WeightedRandomSampler enabled. Class counts: [ 79224 225438 118240  71369]
2026-01-19 07:20:48,157 - INFO - Loading pretrained weights from Hugging Face hub (timm/resnet50.a1_in1k)
2026-01-19 07:20:58,505 - INFO - [timm/resnet50.a1_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2026-01-19 07:20:58,942 - INFO - HybridBackbone Dimensions Detected -> CNN: 2048, ViT: 0
2026-01-19 07:20:58,950 - INFO - CBAM initialized with channels: 2048
2026-01-19 07:21:00,969 - INFO - Initialized AdaFace Loss (Adaptive Margin for low-quality images).
2026-01-19 07:23:15,084 - INFO - Epoch 1 Step [50/15446] - Loss: 27.6682 - Acc: 34.38%
2026-01-19 07:24:34,345 - INFO - Epoch 1 Step [100/15446] - Loss: 30.6957 - Acc: 34.38%
2026-01-19 07:25:53,252 - INFO - Epoch 1 Step [150/15446] - Loss: 8.5328 - Acc: 15.62%
2026-01-19 07:27:17,095 - INFO - Epoch 1 Step [200/15446] - Loss: 25.1120 - Acc: 31.25%
2026-01-19 07:28:34,908 - INFO - Epoch 1 Step [250/15446] - Loss: 7.3848 - Acc: 31.25%
2026-01-19 07:29:54,250 - INFO - Epoch 1 Step [300/15446] - Loss: 9.6717 - Acc: 18.75%
2026-01-19 07:31:28,132 - INFO - Epoch 1 Step [350/15446] - Loss: 7.8474 - Acc: 28.12%
2026-01-19 07:32:58,000 - INFO - Epoch 1 Step [400/15446] - Loss: 24.6222 - Acc: 40.62%
2026-01-19 07:34:18,185 - INFO - Epoch 1 Step [450/15446] - Loss: 5.1197 - Acc: 18.75%
2026-01-19 07:35:42,644 - INFO - Epoch 1 Step [500/15446] - Loss: 22.4478 - Acc: 53.12%
2026-01-19 07:37:08,429 - INFO - Epoch 1 Step [550/15446] - Loss: 8.5162 - Acc: 18.75%
2026-01-19 07:38:19,273 - INFO - Epoch 1 Step [600/15446] - Loss: 8.7833 - Acc: 25.00%
2026-01-19 07:39:20,184 - INFO - Epoch 1 Step [650/15446] - Loss: 3.0756 - Acc: 31.25%
2026-01-19 07:40:41,646 - INFO - Epoch 1 Step [700/15446] - Loss: 6.7646 - Acc: 31.25%
2026-01-19 07:41:40,000 - INFO - Epoch 1 Step [750/15446] - Loss: 11.1708 - Acc: 18.75%
2026-01-19 07:42:31,432 - INFO - Epoch 1 Step [800/15446] - Loss: 20.7635 - Acc: 65.62%
2026-01-19 07:43:31,094 - INFO - Epoch 1 Step [850/15446] - Loss: 18.0248 - Acc: 53.12%
2026-01-19 07:44:41,006 - INFO - Epoch 1 Step [900/15446] - Loss: 20.3567 - Acc: 46.88%
2026-01-19 07:45:56,611 - INFO - Epoch 1 Step [950/15446] - Loss: 20.1971 - Acc: 50.00%
2026-01-19 07:47:01,289 - INFO - Epoch 1 Step [1000/15446] - Loss: 7.5106 - Acc: 21.88%
2026-01-19 07:48:01,401 - INFO - Epoch 1 Step [1050/15446] - Loss: 25.3660 - Acc: 68.75%
2026-01-19 07:49:05,147 - INFO - Epoch 1 Step [1100/15446] - Loss: 23.1410 - Acc: 68.75%
2026-01-19 07:50:22,528 - INFO - Epoch 1 Step [1150/15446] - Loss: 6.3438 - Acc: 37.50%
2026-01-19 07:51:38,201 - INFO - Epoch 1 Step [1200/15446] - Loss: 16.6560 - Acc: 50.00%
2026-01-19 07:52:43,625 - INFO - Epoch 1 Step [1250/15446] - Loss: 19.9286 - Acc: 56.25%
2026-01-19 07:54:01,336 - INFO - Epoch 1 Step [1300/15446] - Loss: 15.4862 - Acc: 43.75%
2026-01-19 07:55:15,910 - INFO - Epoch 1 Step [1350/15446] - Loss: 3.8313 - Acc: 21.88%
2026-01-19 07:56:28,859 - INFO - Epoch 1 Step [1400/15446] - Loss: 14.1299 - Acc: 53.12%
2026-01-19 07:57:46,280 - INFO - Epoch 1 Step [1450/15446] - Loss: 15.5825 - Acc: 28.12%
2026-01-19 07:59:29,187 - INFO - Epoch 1 Step [1500/15446] - Loss: 18.6037 - Acc: 68.75%
2026-01-19 08:00:32,454 - INFO - Epoch 1 Step [1550/15446] - Loss: 11.3739 - Acc: 46.88%
2026-01-19 08:01:22,019 - ERROR - Phase arcface failed: CUDA error: out of memory
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

2026-01-19 08:01:22,119 - ERROR - Traceback (most recent call last):
  File "D:\Done,Toreview\Image Classification\pipeline\run_pipeline.py", line 443, in run_pipeline
    runner()
  File "D:\Done,Toreview\Image Classification\pipeline\run_pipeline.py", line 431, in <lambda>
    "arcface": lambda: run_arcface_phase(cfg), # Pass full cfg to arcface runner to access 'dataset'
  File "D:\Done,Toreview\Image Classification\pipeline\run_pipeline.py", line 141, in run_arcface_phase
    trainer.train()
  File "D:\Done,Toreview\Image Classification\pipeline\train_arcface.py", line 295, in train
    self.scaler.scale(loss).backward()
  File "C:\Users\DELL\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\_tensor.py", line 626, in backward
    torch.autograd.backward(
  File "C:\Users\DELL\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\autograd\__init__.py", line 347, in backward
    _engine_run_backward(
  File "C:\Users\DELL\AppData\Local\Programs\Python\Python310\lib\site-packages\torch\autograd\graph.py", line 823, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
RuntimeError: CUDA error: out of memory
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.



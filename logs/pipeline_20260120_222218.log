2026-01-20 22:22:18,827 - INFO - Loading config from: configs/garbage_edge.yaml
2026-01-20 22:22:18,835 - INFO - ===> Starting ArcFace Training Phase
2026-01-20 22:22:18,837 - INFO - Using CombinedFilesDataset with roots: ['./data']
2026-01-20 22:22:18,844 - INFO - Creating loader from JSON: ./data/Dataset_Final_Aug/dataset_aug_metadata.json
2026-01-20 22:22:20,159 - INFO - Total images in JSON: 617837
2026-01-20 22:22:20,160 - INFO - Splitting dataset: Train=494271, Val=61783, Test=61783
2026-01-20 22:22:20,570 - INFO - JsonDataset loaded 494271 images. Classes: {'organic': 0, 'other': 1, 'paper': 2, 'plastic': 3}
2026-01-20 22:22:20,599 - INFO - JsonDataset loaded 61783 images. Classes: {'organic': 0, 'other': 1, 'paper': 2, 'plastic': 3}
2026-01-20 22:22:20,624 - INFO - JsonDataset loaded 61783 images. Classes: {'organic': 0, 'other': 1, 'paper': 2, 'plastic': 3}
2026-01-20 22:22:20,624 - INFO - Created RAM-Optimized Datasets: Train(494271), Val(61783), Test(61783)
2026-01-20 22:22:20,998 - INFO - WeightedRandomSampler enabled. Class counts: [ 79224 225438 118240  71369]
2026-01-20 22:22:21,416 - INFO - Loading pretrained weights from Hugging Face hub (timm/resnet18.a1_in1k)
2026-01-20 22:22:21,729 - INFO - [timm/resnet18.a1_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2026-01-20 22:22:21,898 - INFO - HybridBackbone Dimensions Detected -> CNN: 512, ViT: 0
2026-01-20 22:22:21,901 - INFO - CBAM initialized with channels: 512
2026-01-20 22:22:22,136 - INFO - Loading SupCon weights from ./snapshots/supcon_final_best.pth...
2026-01-20 22:22:22,318 - INFO - SupCon weights loaded successfully.
2026-01-20 22:22:22,322 - INFO - Initialized AdaFace Loss (Adaptive Margin for low-quality images).
2026-01-20 22:22:29,816 - INFO - Epoch 1 Step [10/30892] - Loss: 3.0786 - Acc: 6.25% - ValLoss: N/A - Patience: N/A
2026-01-20 22:22:34,326 - INFO - Epoch 1 Step [20/30892] - Loss: 13.5403 - Acc: 31.25% - ValLoss: N/A - Patience: N/A
2026-01-20 22:22:38,395 - INFO - Epoch 1 Step [30/30892] - Loss: 32.5373 - Acc: 6.25% - ValLoss: N/A - Patience: N/A
2026-01-20 22:22:42,556 - INFO - Epoch 1 Step [40/30892] - Loss: 8.0218 - Acc: 12.50% - ValLoss: N/A - Patience: N/A
2026-01-20 22:22:46,740 - INFO - Epoch 1 Step [50/30892] - Loss: 30.0318 - Acc: 43.75% - ValLoss: N/A - Patience: N/A
2026-01-20 22:22:51,034 - INFO - Epoch 1 Step [60/30892] - Loss: 15.9225 - Acc: 31.25% - ValLoss: N/A - Patience: N/A
2026-01-20 22:22:55,170 - INFO - Epoch 1 Step [70/30892] - Loss: 23.1011 - Acc: 31.25% - ValLoss: N/A - Patience: N/A
2026-01-20 22:22:59,250 - INFO - Epoch 1 Step [80/30892] - Loss: 9.0346 - Acc: 31.25% - ValLoss: N/A - Patience: N/A
2026-01-20 22:23:03,462 - INFO - Epoch 1 Step [90/30892] - Loss: 8.5625 - Acc: 31.25% - ValLoss: N/A - Patience: N/A
2026-01-20 22:23:07,569 - INFO - Epoch 1 Step [100/30892] - Loss: 23.1298 - Acc: 31.25% - ValLoss: N/A - Patience: N/A
2026-01-20 22:23:11,718 - INFO - Epoch 1 Step [110/30892] - Loss: 15.2056 - Acc: 31.25% - ValLoss: N/A - Patience: N/A
2026-01-20 22:23:15,843 - INFO - Epoch 1 Step [120/30892] - Loss: 5.9237 - Acc: 12.50% - ValLoss: N/A - Patience: N/A
2026-01-20 22:23:19,887 - INFO - Epoch 1 Step [130/30892] - Loss: 17.9211 - Acc: 25.00% - ValLoss: N/A - Patience: N/A
2026-01-20 22:23:23,934 - INFO - Epoch 1 Step [140/30892] - Loss: 15.2897 - Acc: 25.00% - ValLoss: N/A - Patience: N/A
2026-01-20 22:23:27,960 - INFO - Epoch 1 Step [150/30892] - Loss: 30.6439 - Acc: 31.25% - ValLoss: N/A - Patience: N/A
2026-01-20 22:23:31,989 - INFO - Epoch 1 Step [160/30892] - Loss: 14.5510 - Acc: 12.50% - ValLoss: N/A - Patience: N/A
2026-01-20 22:23:36,023 - INFO - Epoch 1 Step [170/30892] - Loss: 30.4109 - Acc: 31.25% - ValLoss: N/A - Patience: N/A
2026-01-20 22:23:40,028 - INFO - Epoch 1 Step [180/30892] - Loss: 31.2653 - Acc: 31.25% - ValLoss: N/A - Patience: N/A
2026-01-20 22:23:43,967 - INFO - Epoch 1 Step [190/30892] - Loss: 31.5452 - Acc: 31.25% - ValLoss: N/A - Patience: N/A
2026-01-20 22:23:47,987 - INFO - Epoch 1 Step [200/30892] - Loss: 8.9650 - Acc: 31.25% - ValLoss: N/A - Patience: N/A
2026-01-20 22:23:52,024 - INFO - Epoch 1 Step [210/30892] - Loss: 20.9724 - Acc: 31.25% - ValLoss: N/A - Patience: N/A
2026-01-20 22:23:56,075 - INFO - Epoch 1 Step [220/30892] - Loss: 27.7380 - Acc: 37.50% - ValLoss: N/A - Patience: N/A
2026-01-20 22:24:00,096 - INFO - Epoch 1 Step [230/30892] - Loss: 19.8073 - Acc: 50.00% - ValLoss: N/A - Patience: N/A
2026-01-20 22:24:04,133 - INFO - Epoch 1 Step [240/30892] - Loss: 7.5159 - Acc: 31.25% - ValLoss: N/A - Patience: N/A
2026-01-20 22:24:08,191 - INFO - Epoch 1 Step [250/30892] - Loss: 10.7106 - Acc: 31.25% - ValLoss: N/A - Patience: N/A
2026-01-20 22:24:12,254 - INFO - Epoch 1 Step [260/30892] - Loss: 12.2475 - Acc: 12.50% - ValLoss: N/A - Patience: N/A
2026-01-20 22:24:16,313 - INFO - Epoch 1 Step [270/30892] - Loss: 29.6550 - Acc: 25.00% - ValLoss: N/A - Patience: N/A

# Data Config
dataset:
  root_dirs:
    - "./data/Augmented_Data_Zip"
  json_path: "./data/Augmented_Data_Zip/dataset_aug_metadata.json"
  batch_size: 64          # Reverted to 64 as requested
  num_workers: 16
  val_split: 0.1 # 10% Validation
  test_split: 0.1 # 10% Hold-out Test
  augment_online: true
  
# -------------------------------------------------------------------------
# Student Model (EfficientNet-B0 + High-Freq CBAM)
# -------------------------------------------------------------------------
backbone: 
  cnn_model: "efficientnet_b0"
  vit_model: null 
  pretrained: true
  use_cbam: "every_2_blocks" 
  dropout: 0.3

# -------------------------------------------------------------------------
# Phase 1: SupCon (Pre-training)
# -------------------------------------------------------------------------
supcon:
  enabled: true
  epochs: 50
  batch_size: 64
  lr: 1.0e-3
  steps: 2000
  use_sam: true
  snapshot_path: "./snapshots_advanced/supcon_final.pth" # Save here

# -------------------------------------------------------------------------
# Phase 2: ArcFace (ULMFiT Fine-Tuning)
# -------------------------------------------------------------------------
arcface:
  enabled: true
  epochs: 20
  lr: 1.0e-4
  snapshot_dir: "./snapshots_advanced"
  
  # ULMFiT Strategy
  use_ulmfit: true
  gradual_unfreezing: true
  unfreeze_epoch: 4 # Epochs 1-3 are Head Only, Epoch 4+ Full
  discriminative_lr_decay: 2.6
  
  use_sam: true
  use_amp: true
  val_limit_batches: 10 # Check only 10 batches every 10 steps

# -------------------------------------------------------------------------
# Phase 3: Distillation (DISABLED)
# -------------------------------------------------------------------------
distill:
  enabled: false
  
embedding_size: 512
num_classes: 4
